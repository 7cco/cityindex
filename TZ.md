# Техническое задание на проект: Индекс инвестиционной привлекательности маленьких городов

## 1. Цель проекта
Создание сервиса для оценки инвестиционного потенциала малых городов РФ (до 100 тыс. жителей) на основе открытых данных. Система решает проблему отсутствия объективных инструментов для быстрой оценки привлекательности городов при запуске малого бизнеса, социальных проектов или инфраструктурных инициатив. Сервис автоматически собирает данные из официальных источников, рассчитывает комплексный индекс и визуализирует результаты для принятия решений.

## 2. Роли пользователей
- **Гость**:  
  — Просмотр ТОП-20 городов по индексу  
  — **Просмотр регионального рейтинга (таблица с цветовой дифференциацией по регионам)**  
  — Доступ к демо-сравнению 3 городов
- **Аналитик** (зарегистрированный пользователь):  
  — Фильтрация по регионам и населению  
  — Сравнение до 10 городов с визуализацией через столбчатые диаграммы  
  — Экспорт данных в CSV

## 3. Модели данных
**Locality** (Город):  
— `city` (название)  
— `region` (субъект РФ)  
— `population` (численность населения)  
— `oktmo_code` (код ОКТМО для связи с данными)
— `is_active` (флаг участия в рейтинге)

**EconomicData** (Экономические показатели):  
— `locality` (связь ForeignKey с Locality)  
— `year` (год данных)  
— `ndfl_total` (сумма НДФЛ в рублях)  
— `unemployment_rate` (уровень безработицы, %)

**InfrastructureData** (Инфраструктура):  
— `locality` (связь OneToOne с Locality)  
— `schools` (количество школ)  
— `gas_stations` (количество АЗС)  
— `bus_stops` (количество остановок общественного транспорта)  

## 4. Ключевой функционал (User Stories)
* **Региональный рейтинг**: Пользователь выбирает регион из выпадающего списка, система отображает таблицу городов региона с цветовой индикацией инвестиционного индекса (красный → желтый → зеленый) и возможностью сортировки по любому показателю.
* **Сравнение городов**: Аналитик отмечает 2-10 городов, система генерирует столбчатую диаграмму Plotly с разбивкой по трем компонентам индекса (экономика, демография, инфраструктура) для наглядного сравнения сильных/слабых сторон.
* **Экспорт в CSV**: Зарегистрированный пользователь экспортирует данные сравнения в CSV с колонками: Город, Регион, Население, НДФЛ на душу, Индекс, Компоненты индекса.
* **Автоматизация данных**: Администратор запускает консольную команду , система обновляет данные напрямую из открытых источников.

## 5. Внешние интеграции и аналитика
**Интеграции**:  
— Парсинг открытых Excel-файлов Росстата и УФНС по регионам (Калужская, Тульская, Липецкая области) через `pandas`  
— Запросы к Overpass API для получения инфраструктурных объектов из OpenStreetMap

**Аналитика**:  
— Расчет инвестиционного индекса по формуле:  
`Индекс = 0.4 * (доходы на душу / медиана по региону) + 0.3 * (1 - уровень безработицы региона / 100 ) + 0.3 * (инфраструктурный балл)`
— Использование библиотеки `Plotly` для генерации интерактивных графиков динамики показателей в шаблонах Django  
— Нормализация данных через региональные средние значения